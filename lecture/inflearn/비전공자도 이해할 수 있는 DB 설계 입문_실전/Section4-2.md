# DB 설계 규칙 6가지

## 2. 어떤 테이블에 FK를 넣어도 '규칙 1'을 못 지킬 때는 중간 매핑테이블을 하나 더 만들어라.

FK(외래 키)를 활용할 때도 **한 칸에 한 가지 정보만 넣는 규칙(규칙 1)**을 지키는 것이 중요하다. 하지만 어떤 상황에서는 특정 테이블에 FK를 넣어도 여전히 한 칸에 여러 정보가 들어가게 된다. 이 경우에는 중간 매핑 테이블을 추가하여 해결할 수 있다.

---

### **예시: 학생과 수강 과목**
학생이 여러 과목을 수강할 수 있고, 한 과목에 여러 학생이 등록할 수 있는 다대다(M:N) 관계를 설계한다고 가정하자.

**[잘못된 설계]**

**students (학생)**

| id (PK) | 이름 | 수강 과목 id (FK) |
| --- | --- | --- |
| 1 | 김철수 | 1, 2 |
| 2 | 이영희 | 2, 3 |

**subjects (과목)**

| id (PK) | 과목명 |
| --- | --- |
| 1 | 수학 |
| 2 | 과학 |
| 3 | 영어 |

- **문제점:** `students` 테이블의 `수강 과목 id` 컬럼에 여러 값이 들어가 있어 규칙 1이 위배된다.
- **해결 방법:** 중간 매핑 테이블을 생성하여 학생과 과목의 관계를 별도로 관리한다.

---

**[중간 매핑 테이블을 사용한 설계]**

**students (학생)**

| id (PK) | 이름 |
| --- | --- |
| 1 | 김철수 |
| 2 | 이영희 |

**subjects (과목)**

| id (PK) | 과목명 |
| --- | --- |
| 1 | 수학 |
| 2 | 과학 |
| 3 | 영어 |

**student_subjects (학생-과목 매핑)**

| id (PK) | 학생 id (FK) | 과목 id (FK) |
| --- | --- | --- |
| 1 | 1 | 1 |
| 2 | 1 | 2 |
| 3 | 2 | 2 |
| 4 | 2 | 3 |

- **설명:** `student_subjects`라는 중간 매핑 테이블을 생성하여 학생과 과목 간의 관계를 관리한다.
- **장점:** 
  - 규칙 1을 지키며 다대다 관계를 효과적으로 표현할 수 있다.
  - 추가적인 속성(예: 수강 신청 날짜, 점수 등)을 중간 매핑 테이블에 쉽게 추가할 수 있다.

---

### **예시: 주문과 제품**
한 주문에 여러 제품이 포함될 수 있고, 한 제품이 여러 주문에 포함될 수 있는 다대다(M:N) 관계를 설계한다고 가정하자.

**[잘못된 설계]**

**orders (주문)**

| id (PK) | 주문자 | 제품 id (FK) |
| --- | --- | --- |
| 1 | 박지훈 | 1, 2 |
| 2 | 김나연 | 2, 3 |

**products (제품)**

| id (PK) | 제품명 |
| --- | --- |
| 1 | 노트북 |
| 2 | 스마트폰 |
| 3 | 충전기 |

- **문제점:** `orders` 테이블의 `제품 id` 컬럼에 여러 값이 들어가 있어 규칙 1이 위배된다.
- **해결 방법:** 중간 매핑 테이블을 생성하여 주문과 제품의 관계를 별도로 관리한다.

---

**[중간 매핑 테이블을 사용한 설계]**

**orders (주문)**

| id (PK) | 주문자 |
| --- | --- |
| 1 | 박지훈 |
| 2 | 김나연 |

**products (제품)**

| id (PK) | 제품명 |
| --- | --- |
| 1 | 노트북 |
| 2 | 스마트폰 |
| 3 | 충전기 |

**order_products (주문-제품 매핑)**

| id (PK) | 주문 id (FK) | 제품 id (FK) |
| --- | --- | --- |
| 1 | 1 | 1 |
| 2 | 1 | 2 |
| 3 | 2 | 2 |
| 4 | 2 | 3 |

- **설명:** `order_products`라는 중간 매핑 테이블을 생성하여 주문과 제품 간의 관계를 관리한다.
- **장점:** 
  - 다대다 관계를 효과적으로 분리하고, 규칙 1을 지킨다.
  - 주문별 제품 수량, 할인율 등 추가 정보를 매핑 테이블에 쉽게 저장할 수 있다.

---

중간 매핑 테이블을 사용하는 것은 다대다 관계를 표현할 때뿐만 아니라, 복잡한 데이터 관계를 단순화하고 데이터 무결성을 유지하는 데 매우 유용하다.
