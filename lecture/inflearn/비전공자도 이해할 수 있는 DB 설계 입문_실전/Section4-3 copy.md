# DB 설계 규칙 6가지

## 3. 헷갈릴 땐 관계(1:1, 1:N, N:M)를 파악해봐라

데이터를 설계할 때 가장 중요한 것은 테이블 간의 관계를 파악하는 것이다. 관계를 명확히 파악하면 테이블을 어떻게 설계해야 할지 쉽게 결정할 수 있다. 관계는 크게 **1:1 관계**, **1:N 관계**, **N:M 관계**로 나눌 수 있다.

---

### 1:1 관계
1:1 관계는 한 엔티티가 다른 엔티티와 정확히 하나의 데이터와 연결될 때 발생한다.

**[예시: 사용자와 사용자 프로필]**

- 사용자 정보는 `users` 테이블에, 프로필 정보는 `profiles` 테이블에 저장된다.
- 각 사용자는 하나의 프로필만 가질 수 있다.

**[테이블 설계]**

**users (사용자)**

| id (PK) | 이름 |
| --- | --- |
| 1 | 김철수 |
| 2 | 이영희 |

**profiles (프로필)**

| id (PK) | 사용자 id (FK) | 프로필 이미지 | 자기소개 |
| --- | --- | --- | --- |
| 1 | 1 | profile1.jpg | 안녕하세요, 김철수입니다. |
| 2 | 2 | profile2.jpg | 안녕하세요, 이영희입니다. |

- **설명:** `profiles` 테이블의 `사용자 id`는 `users` 테이블의 `id`와 1:1로 매칭된다.
- **활용:** 테이블 분리를 통해 데이터 접근 속도를 높이고, 각 테이블의 역할을 명확히 할 수 있다.

---

### 1:N 관계
1:N 관계는 하나의 엔티티가 여러 개의 다른 엔티티와 연결될 때 발생한다.

**[예시: 카테고리와 제품]**

- 하나의 카테고리는 여러 제품을 포함할 수 있다.
- 각 제품은 하나의 카테고리에만 속한다.

**[테이블 설계]**

**categories (카테고리)**

| id (PK) | 카테고리명 |
| --- | --- |
| 1 | 전자제품 |
| 2 | 가구 |

**products (제품)**

| id (PK) | 제품명 | 카테고리 id (FK) |
| --- | --- | --- |
| 1 | 노트북 | 1 |
| 2 | 스마트폰 | 1 |
| 3 | 의자 | 2 |
| 4 | 테이블 | 2 |

- **설명:** `products` 테이블의 `카테고리 id`는 `categories` 테이블의 `id`를 참조하여 여러 제품이 하나의 카테고리에 연결된다.
- **활용:** 각 카테고리별로 제품을 쉽게 조회할 수 있다.

---

### N:M 관계
N:M 관계는 여러 엔티티가 여러 엔티티와 연결될 때 발생한다. 이를 표현하기 위해 **중간 매핑 테이블**이 필요하다.

**[예시: 학생과 과목]**

- 학생은 여러 과목을 수강할 수 있고, 한 과목에는 여러 학생이 등록될 수 있다.

**[테이블 설계]**

**students (학생)**

| id (PK) | 이름 |
| --- | --- |
| 1 | 김철수 |
| 2 | 이영희 |

**subjects (과목)**

| id (PK) | 과목명 |
| --- | --- |
| 1 | 수학 |
| 2 | 과학 |
| 3 | 영어 |

**student_subjects (학생-과목 매핑)**

| id (PK) | 학생 id (FK) | 과목 id (FK) |
| --- | --- | --- |
| 1 | 1 | 1 |
| 2 | 1 | 2 |
| 3 | 2 | 2 |
| 4 | 2 | 3 |

- **설명:** `student_subjects` 테이블은 학생과 과목 간의 N:M 관계를 중간 매핑 테이블로 관리한다.
- **활용:** N:M 관계를 유연하게 처리하고 추가 정보를 저장할 수 있다.

---

### 엔티티 관계 파악 방법

#### 1. 엔티티 간에 어울리는 동사 찾기
관계를 파악할 때는 두 엔티티 간의 의미를 동사로 표현해보면 명확해진다.

- `A(주어)가 B를 _____.` (A가 주어)
  - 예: 학생이 과목을 수강한다.
  - 결과: 학생-과목은 N:M 관계.

- `B(주어)가 A에 의해 _____.` (B가 주어)
  - 예: 과목이 학생에 의해 수강된다.
  - 결과: 과목-학생은 N:M 관계.

#### 2. 관계를 기준으로 테이블 분리 여부 결정
- 1:1 관계: 엔티티를 분리하고 FK로 연결.
- 1:N 관계: N 테이블에 FK 추가.
- N:M 관계: 중간 매핑 테이블을 생성.
