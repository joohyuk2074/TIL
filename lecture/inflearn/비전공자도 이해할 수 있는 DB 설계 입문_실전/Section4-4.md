# DB 설계 규칙 6가지

## 4. 데이터 중복이 발생하는 컬럼이 있는지 확인해라
데이터베이스 설계 시 데이터 중복이 발생하면 저장 공간 낭비, 데이터 무결성 문제, 유지보수 비용 증가 등의 문제가 발생할 수 있다. 따라서, 데이터 중복 가능성을 미리 시뮬레이션하여 중복이 발생하는 컬럼을 찾아야 한다.

---

### 데이터 중복이란?

- 동일한 데이터가 여러 행에 반복적으로 저장되는 경우를 의미한다.
- 예를 들어, 고객의 도시 정보가 여러 고객 레코드에서 반복된다면 이는 데이터 중복의 한 예이다.

---

### 데이터 중복 사례

**[예시: 고객과 도시 정보]**

**[잘못된 설계]**

**customers (고객)**

| id (PK) | 이름    | 도시          |
|---------|---------|---------------|
| 1       | 김철수  | 서울특별시 강남구 |
| 2       | 이영희  | 서울특별시 강남구 |
| 3       | 박지훈  | 부산광역시 해운대구 |
| 4       | 최민수  | 서울특별시 강남구 |

- **문제점:** 
  - 도시 정보가 여러 행에서 반복적으로 저장된다.
  - 저장 공간 낭비 및 데이터 변경 시 모든 행을 수정해야 하는 비효율 발생.

**[해결 방법: 테이블 분리]**

- 도시 정보를 별도의 테이블로 분리하고, FK로 참조하도록 설계한다.

**[분리 후 설계]**

**customers (고객)**

| id (PK) | 이름    | 도시 id (FK) |
|---------|---------|-------------|
| 1       | 김철수  | 1           |
| 2       | 이영희  | 1           |
| 3       | 박지훈  | 2           |
| 4       | 최민수  | 1           |

**cities (도시)**

| id (PK) | 도시 이름          |
|---------|-------------------|
| 1       | 서울특별시 강남구 |
| 2       | 부산광역시 해운대구 |

- **장점:** 
  - 도시 정보는 `cities` 테이블에 한 번만 저장된다.
  - 중복된 도시 정보를 제거하여 저장 공간을 절약하고, 도시 데이터 수정 시 단일 위치에서 처리 가능.

---

### 데이터 중복 시뮬레이션
데이터 중복 여부를 확인하려면 기존 데이터를 분석하거나 샘플 데이터를 시뮬레이션하여 중복된 값의 빈도를 확인한다.

#### 시뮬레이션 절차
1. 테이블에서 특정 컬럼을 기준으로 그룹화하고 중복된 값의 빈도를 확인.
   ```sql
   SELECT 도시, COUNT(*)
   FROM customers
   GROUP BY 도시
   HAVING COUNT(*) > 1;
